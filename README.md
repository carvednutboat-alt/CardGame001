# Unity 卡牌肉鸽游戏

这是一个基于 Unity 的卡牌战斗游戏原型。目前包含卡牌打出、单位召唤、战斗伤害结算以及指向性法术系统。

## 📅 更新日志 (Changelog)

### [v0.3.1] - 2025-12-17 (当前版本)

- **✨ 新增功能 (Features)**

  - **攻击模式变更**：从“点击怪兽直接攻击”改为 “先选中我方怪兽 -> 再点击敌方实体” 的二段式操作，为未来多敌人战斗做准备。
  - **敌人实体化**：给敌人 (Enemy) 添加了 UI 交互脚本 (EnemyUnitUI)，现在敌人可以被点击选中了。
  - **召唤限制**：新增规则 “每回合只能召唤一次怪兽”，防止铺场过快。

- **🐛 修复 (Fixes)**

  - **装备牌生命周期修复**：装备卡使用后不再直接进弃牌堆，而是正确地依附在怪兽身上。当怪兽阵亡 (KillUnit) 时，其身上的所有装备牌会自动进入弃牌堆，实现了资源循环。
  - **UI 刷新修复**：修复了“万具武”进化后，卡面数值（ATK/HP）没有立刻更新的问题。

- **📦 资源 (Assets)**

  - **管理器拆分**：BattleManager 进一步瘦身，具体的 UI 交互逻辑（如敌人点击、怪兽点击）分发给了 EnemyUnitUI 和 BattleManager 的新状态机。
  - **DeckManager 增强**：新增 RemoveCardFromHand 方法，支持“移出手牌但不进弃牌堆”的操作（用于装备/召唤）。

---

### [v0.3.0] - 2025-12-16

- **✨ 新增功能 (Features)**

  - 墓地系统：新增 Graveyard 列表，单位阵亡后进入墓地。
  - 墓地查看面板：添加了 UI 界面，点击按钮可查看墓地中的卡牌（只读状态）。

- **🐛 修复 (Fixes)**

  - **生命值机制调整**：装备增加最大生命值时，现在会同步增加等量的当前生命值（起到回血作用）。
  - **UI 刷新修复**：修复了“万具武”进化后，卡面数值（ATK/HP）没有立刻更新的问题。

- **📦 资源 (Assets)**

  - **管理器拆分**：将臃肿的 BattleManager 拆分为 DeckManager (牌堆/手牌)、UnitManager (单位/墓地)、EnemyManager (敌人)、CombatManager (数值计算) 和 UIManager (界面显示)。
  - **运行时数据分离**：引入 RuntimeCard 和 RuntimeUnit 类，将静态配置 (CardData) 与运行时状态（如当前血量、唯一 ID）分离，解决了同名卡数据同步修改的 Bug。
  - **效果系统多态**：移除 switch-case 结构，采用工厂模式 (EffectFactory) 和策略模式 (EffectLogic) 处理卡牌效果，现在新增效果只需添加新类，无需修改管理器代码。

---

### [v0.2.0] - 2025-12-15

**主要更新：战斗系统重构与 UI 修复**

- **✨ 新增功能 (Features)**

  - **指向性法术系统**：新增 `isTargetingMode`，支持使用“往日种种”治疗卡牌点击场上单位进行互动。
  - **动态字体支持**：引入 `msyh SDF` (微软雅黑)，解决中文显示乱码问题。
  - **自动滚动日志**：战斗日志现在使用 `ScrollView`，并会在有新消息时自动滚动到底部。
  - **Layout Element**：给怪兽预制体添加了布局元素，防止在父容器中大小异常。

- **🐛 修复 (Fixes)**

  - 修复了 `FieldUnitUI` 的 Raycast Target 遮挡 Button 点击的问题。
  - 修复了手牌区 (HandPanel) 与备战区 (FieldUnitPanel) 的布局重叠。
  - 修复了 Start 阶段 UI 初始化顺序导致的报错。
  - 解决了 `.gitignore` 未忽略 `.vs` 文件夹的问题。

- **📦 资源 (Assets)**

  - 新增卡牌数据：“往日种种”。

---

### [v0.1.0] - 2025-12-14

- 项目初始化。
- 实现了基础的 BattleManager 回合制逻辑。
- 实现了基础的抽牌逻辑。

## 🎮 如何运行

1. 使用 Unity 6000.2.5f1 打开项目。
2. 打开 `Assets/BattleScene` 场景。
3. 点击 Play 即可开始测试。
